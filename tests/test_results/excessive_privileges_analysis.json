{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsIm5hbWUiOiJTdXBlciBBZG1pbiIsInJvbGUiOiJhZG1pbiIsInBlcm1pc3Npb25zIjpbIioiLCJhZG1pbiIsInJlYWQiLCJ3cml0ZSIsImRlbGV0ZSJdLCJpYXQiOjE3NDIxODE2OTQsImV4cCI6MTc0NDc3MzY5NH0.ydtOuu_B6v2PvBdC8cD_jud0OG2BHbY0ZBUsJjnOx9c",
  "timestamp": "2025-03-16T20:21:34.317667",
  "overview": {
    "algorithm": "HS256",
    "token_type": "JWT",
    "is_expired": false,
    "issuer": "unknown",
    "subject": "admin",
    "audience": "unknown",
    "issued_at": "2025-03-17 03:21:34+00:00",
    "expires_at": "2025-04-16 03:21:34+00:00"
  },
  "token_data": {
    "header": {
      "alg": "HS256",
      "typ": "JWT"
    },
    "payload": {
      "sub": "admin",
      "name": "Super Admin",
      "role": "admin",
      "permissions": [
        "*",
        "admin",
        "read",
        "write",
        "delete"
      ],
      "iat": 1742181694,
      "exp": 1744773694
    },
    "signature": "ydtOuu_B6v2PvBdC8cD_jud0OG2BHbY0ZBUsJjnOx9c",
    "is_expired": false,
    "expiry_time": "2025-04-16 03:21:34+00:00",
    "issue_time": "2025-03-17 03:21:34+00:00",
    "raw_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsIm5hbWUiOiJTdXBlciBBZG1pbiIsInJvbGUiOiJhZG1pbiIsInBlcm1pc3Npb25zIjpbIioiLCJhZG1pbiIsInJlYWQiLCJ3cml0ZSIsImRlbGV0ZSJdLCJpYXQiOjE3NDIxODE2OTQsImV4cCI6MTc0NDc3MzY5NH0.ydtOuu_B6v2PvBdC8cD_jud0OG2BHbY0ZBUsJjnOx9c"
  },
  "expiration_analysis": {
    "has_expiration": true,
    "is_expired": false,
    "time_until_expiry": {
      "days": 29,
      "hours": 23,
      "minutes": 59,
      "seconds": 59
    },
    "total_lifetime": {
      "days": 30,
      "hours": 0,
      "minutes": 0,
      "seconds": 0,
      "total_seconds": 2592000.0
    },
    "time_since_issue": {
      "days": 0,
      "hours": 0,
      "minutes": 0,
      "seconds": 0
    },
    "percentage_lifetime_remaining": 99.9999877439429,
    "issues": [
      {
        "id": "excessive_lifetime",
        "description": "Token lifetime exceeds 7 days (30 days)",
        "severity": "High"
      },
      {
        "id": "missing_nbf",
        "description": "Token is missing the 'nbf' (not before) claim",
        "severity": "Low"
      }
    ]
  },
  "vulnerabilities": [
    {
      "id": "long_expiration",
      "title": "The token has a long lifetime of 30 days",
      "severity": "Medium",
      "description": "Tokens with long lifetimes increase the window of opportunity for attackers if the token is compromised."
    },
    {
      "id": "missing_claims",
      "title": "The token is missing recommended claims: 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), 'aud' (audience)",
      "severity": "Low",
      "description": "These claims enhance token security by allowing more precise validation rules."
    },
    {
      "id": "admin_privileges",
      "title": "The token contains administrative privileges",
      "severity": "Medium",
      "description": "Tokens with admin privileges should be short-lived and carefully protected. Consider using principle of least privilege."
    },
    {
      "id": "wildcard_permissions",
      "title": "The token contains wildcard or broad permissions",
      "severity": "High",
      "description": "Wildcard permissions grant excessive access and violate the principle of least privilege."
    }
  ],
  "threats": [
    {
      "id": "missing_jti",
      "title": "Token does not have a JWT ID (jti) claim",
      "severity": "Medium",
      "description": "Without a unique identifier, it's harder to implement token revocation and detect token reuse."
    }
  ],
  "risk_assessment": {
    "risk_score": 26,
    "risk_level": "Medium",
    "vulnerability_count": {
      "Critical": 0,
      "High": 1,
      "Medium": 3,
      "Low": 1
    },
    "total_issues": 5,
    "severe_issues": [
      {
        "id": "wildcard_permissions",
        "title": "The token contains wildcard or broad permissions",
        "severity": "High",
        "description": "Wildcard permissions grant excessive access and violate the principle of least privilege."
      }
    ],
    "expiration_risk": "Low"
  },
  "recommendations": [
    "Reduce token lifetime to minimize the window of opportunity for attackers. For sensitive operations, consider using short-lived tokens (minutes to hours).",
    "Include recommended JWT claims such as 'iat' (issued at), 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), and 'aud' (audience) to enhance security.",
    "Set secure cookie attributes: HttpOnly (prevents JavaScript access), Secure (requires HTTPS), and SameSite=Strict (prevents CSRF attacks).",
    "Follow the principle of least privilege. Only include the permissions that are strictly necessary for the token's purpose.",
    "Implement token validation on all protected routes, checking for valid signatures, expiration times, and appropriate scopes/permissions.",
    "Rotate signing keys periodically. Implement a key rotation strategy that allows for seamless transition between old and new keys."
  ],
  "exploits": {
    "none_algorithm": {
      "success": true,
      "modified_token": "eyJhbGciOiAibm9uZSIsICJ0eXAiOiAiSldUIn0.eyJzdWIiOiJhZG1pbiIsIm5hbWUiOiJTdXBlciBBZG1pbiIsInJvbGUiOiJhZG1pbiIsInBlcm1pc3Npb25zIjpbIioiLCJhZG1pbiIsInJlYWQiLCJ3cml0ZSIsImRlbGV0ZSJdLCJpYXQiOjE3NDIxODE2OTQsImV4cCI6MTc0NDc3MzY5NH0.",
      "description": "Attempted to bypass signature validation by changing algorithm to 'none'"
    },
    "header_manipulation": {
      "success": true,
      "modified_token": "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCIsICJqd2siOiB7Imt0eSI6ICJvY3QiLCAiayI6ICIifX0.eyJzdWIiOiJhZG1pbiIsIm5hbWUiOiJTdXBlciBBZG1pbiIsInJvbGUiOiJhZG1pbiIsInBlcm1pc3Npb25zIjpbIioiLCJhZG1pbiIsInJlYWQiLCJ3cml0ZSIsImRlbGV0ZSJdLCJpYXQiOjE3NDIxODE2OTQsImV4cCI6MTc0NDc3MzY5NH0.ydtOuu_B6v2PvBdC8cD_jud0OG2BHbY0ZBUsJjnOx9c",
      "description": "Attempted to manipulate header parameters"
    },
    "weak_key": {
      "success": false,
      "cracked_secret": null,
      "description": "Attempted to crack the token using common weak secrets"
    }
  }
}