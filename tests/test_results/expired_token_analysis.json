{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMTAxIiwibmFtZSI6IkV4cGlyZWQgVXNlciIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzQyMDA4ODk0LCJleHAiOjE3NDIwOTUyOTR9.3f-vq34giHXHqC6Jx-pZE-s3Gj0t4_twtiCO_NenZ_E",
  "timestamp": "2025-03-16T20:21:34.317432",
  "overview": {
    "algorithm": "HS256",
    "token_type": "JWT",
    "is_expired": true,
    "issuer": "unknown",
    "subject": "user101",
    "audience": "unknown",
    "issued_at": "2025-03-15 03:21:34+00:00",
    "expires_at": "2025-03-16 03:21:34+00:00"
  },
  "token_data": {
    "header": {
      "alg": "HS256",
      "typ": "JWT"
    },
    "payload": {
      "sub": "user101",
      "name": "Expired User",
      "role": "user",
      "iat": 1742008894,
      "exp": 1742095294
    },
    "signature": "3f-vq34giHXHqC6Jx-pZE-s3Gj0t4_twtiCO_NenZ_E",
    "is_expired": true,
    "expiry_time": "2025-03-16 03:21:34+00:00",
    "issue_time": "2025-03-15 03:21:34+00:00",
    "raw_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMTAxIiwibmFtZSI6IkV4cGlyZWQgVXNlciIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzQyMDA4ODk0LCJleHAiOjE3NDIwOTUyOTR9.3f-vq34giHXHqC6Jx-pZE-s3Gj0t4_twtiCO_NenZ_E"
  },
  "expiration_analysis": {
    "has_expiration": true,
    "is_expired": true,
    "time_until_expiry": null,
    "total_lifetime": {
      "days": 1,
      "hours": 0,
      "minutes": 0,
      "seconds": 0,
      "total_seconds": 86400.0
    },
    "time_since_issue": null,
    "percentage_lifetime_remaining": null,
    "issues": [
      {
        "id": "missing_nbf",
        "description": "Token is missing the 'nbf' (not before) claim",
        "severity": "Low"
      }
    ]
  },
  "vulnerabilities": [
    {
      "id": "expired_token",
      "title": "The token has expired",
      "severity": "Medium",
      "description": "The token has passed its expiration time and should not be accepted anymore."
    },
    {
      "id": "missing_claims",
      "title": "The token is missing recommended claims: 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), 'aud' (audience)",
      "severity": "Low",
      "description": "These claims enhance token security by allowing more precise validation rules."
    }
  ],
  "threats": [
    {
      "id": "missing_jti",
      "title": "Token does not have a JWT ID (jti) claim",
      "severity": "Medium",
      "description": "Without a unique identifier, it's harder to implement token revocation and detect token reuse."
    }
  ],
  "risk_assessment": {
    "risk_score": 11,
    "risk_level": "Low",
    "vulnerability_count": {
      "Critical": 0,
      "High": 0,
      "Medium": 2,
      "Low": 1
    },
    "total_issues": 3,
    "severe_issues": [],
    "expiration_risk": "High"
  },
  "recommendations": [
    "Include recommended JWT claims such as 'iat' (issued at), 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), and 'aud' (audience) to enhance security.",
    "Set secure cookie attributes: HttpOnly (prevents JavaScript access), Secure (requires HTTPS), and SameSite=Strict (prevents CSRF attacks).",
    "Implement token validation on all protected routes, checking for valid signatures, expiration times, and appropriate scopes/permissions.",
    "Rotate signing keys periodically. Implement a key rotation strategy that allows for seamless transition between old and new keys."
  ],
  "exploits": {
    "none_algorithm": {
      "success": true,
      "modified_token": "eyJhbGciOiAibm9uZSIsICJ0eXAiOiAiSldUIn0.eyJzdWIiOiJ1c2VyMTAxIiwibmFtZSI6IkV4cGlyZWQgVXNlciIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzQyMDA4ODk0LCJleHAiOjE3NDIwOTUyOTR9.",
      "description": "Attempted to bypass signature validation by changing algorithm to 'none'"
    },
    "header_manipulation": {
      "success": true,
      "modified_token": "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCIsICJqd2siOiB7Imt0eSI6ICJvY3QiLCAiayI6ICIifX0.eyJzdWIiOiJ1c2VyMTAxIiwibmFtZSI6IkV4cGlyZWQgVXNlciIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzQyMDA4ODk0LCJleHAiOjE3NDIwOTUyOTR9.3f-vq34giHXHqC6Jx-pZE-s3Gj0t4_twtiCO_NenZ_E",
      "description": "Attempted to manipulate header parameters"
    },
    "weak_key": {
      "success": false,
      "cracked_secret": null,
      "description": "Attempted to crack the token using common weak secrets"
    }
  }
}