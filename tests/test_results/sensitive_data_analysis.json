{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMjAyIiwibmFtZSI6IlNlbnNpdGl2ZSBEYXRhIFVzZXIiLCJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJjcmVkaXRfY2FyZCI6IjQxMTEtMTExMS0xMTExLTExMTEiLCJwYXNzd29yZCI6Imhhc2hlZF9wYXNzd29yZF9oZXJlIiwiaWF0IjoxNzQyMTgxNjk0LCJleHAiOjE3NDIyNjgwOTR9.F3v1ufWz8h9RlfJDk_fhMNRVYxVGH1reSq4aEnui-4o",
  "timestamp": "2025-03-16T20:21:34.317922",
  "overview": {
    "algorithm": "HS256",
    "token_type": "JWT",
    "is_expired": false,
    "issuer": "unknown",
    "subject": "user202",
    "audience": "unknown",
    "issued_at": "2025-03-17 03:21:34+00:00",
    "expires_at": "2025-03-18 03:21:34+00:00"
  },
  "token_data": {
    "header": {
      "alg": "HS256",
      "typ": "JWT"
    },
    "payload": {
      "sub": "user202",
      "name": "Sensitive Data User",
      "email": "user@example.com",
      "credit_card": "4111-1111-1111-1111",
      "password": "hashed_password_here",
      "iat": 1742181694,
      "exp": 1742268094
    },
    "signature": "F3v1ufWz8h9RlfJDk_fhMNRVYxVGH1reSq4aEnui-4o",
    "is_expired": false,
    "expiry_time": "2025-03-18 03:21:34+00:00",
    "issue_time": "2025-03-17 03:21:34+00:00",
    "raw_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMjAyIiwibmFtZSI6IlNlbnNpdGl2ZSBEYXRhIFVzZXIiLCJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJjcmVkaXRfY2FyZCI6IjQxMTEtMTExMS0xMTExLTExMTEiLCJwYXNzd29yZCI6Imhhc2hlZF9wYXNzd29yZF9oZXJlIiwiaWF0IjoxNzQyMTgxNjk0LCJleHAiOjE3NDIyNjgwOTR9.F3v1ufWz8h9RlfJDk_fhMNRVYxVGH1reSq4aEnui-4o"
  },
  "expiration_analysis": {
    "has_expiration": true,
    "is_expired": false,
    "time_until_expiry": {
      "days": 0,
      "hours": 23,
      "minutes": 59,
      "seconds": 59
    },
    "total_lifetime": {
      "days": 1,
      "hours": 0,
      "minutes": 0,
      "seconds": 0,
      "total_seconds": 86400.0
    },
    "time_since_issue": {
      "days": 0,
      "hours": 0,
      "minutes": 0,
      "seconds": 0
    },
    "percentage_lifetime_remaining": 99.99963202314815,
    "issues": [
      {
        "id": "missing_nbf",
        "description": "Token is missing the 'nbf' (not before) claim",
        "severity": "Low"
      }
    ]
  },
  "vulnerabilities": [
    {
      "id": "missing_claims",
      "title": "The token is missing recommended claims: 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), 'aud' (audience)",
      "severity": "Low",
      "description": "These claims enhance token security by allowing more precise validation rules."
    },
    {
      "id": "sensitive_email",
      "title": "The token contains potentially sensitive email data",
      "severity": "High",
      "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
    },
    {
      "id": "sensitive_credit_card",
      "title": "The token contains potentially sensitive credit card data",
      "severity": "High",
      "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
    },
    {
      "id": "sensitive_password",
      "title": "The token contains potentially sensitive password data",
      "severity": "High",
      "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
    }
  ],
  "threats": [
    {
      "id": "missing_jti",
      "title": "Token does not have a JWT ID (jti) claim",
      "severity": "Medium",
      "description": "Without a unique identifier, it's harder to implement token revocation and detect token reuse."
    }
  ],
  "risk_assessment": {
    "risk_score": 36,
    "risk_level": "Medium",
    "vulnerability_count": {
      "Critical": 0,
      "High": 3,
      "Medium": 1,
      "Low": 1
    },
    "total_issues": 5,
    "severe_issues": [
      {
        "id": "sensitive_email",
        "title": "The token contains potentially sensitive email data",
        "severity": "High",
        "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
      },
      {
        "id": "sensitive_credit_card",
        "title": "The token contains potentially sensitive credit card data",
        "severity": "High",
        "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
      },
      {
        "id": "sensitive_password",
        "title": "The token contains potentially sensitive password data",
        "severity": "High",
        "description": "Storing sensitive data in JWT tokens is not recommended as they are typically only base64 encoded, not encrypted."
      }
    ],
    "expiration_risk": "Low"
  },
  "recommendations": [
    "Include recommended JWT claims such as 'iat' (issued at), 'nbf' (not before), 'jti' (JWT ID), 'iss' (issuer), and 'aud' (audience) to enhance security.",
    "Set secure cookie attributes: HttpOnly (prevents JavaScript access), Secure (requires HTTPS), and SameSite=Strict (prevents CSRF attacks).",
    "Avoid storing sensitive data in JWT tokens as they are only Base64 encoded, not encrypted. Store sensitive data in your backend systems instead.",
    "Implement token validation on all protected routes, checking for valid signatures, expiration times, and appropriate scopes/permissions.",
    "Rotate signing keys periodically. Implement a key rotation strategy that allows for seamless transition between old and new keys."
  ],
  "exploits": {
    "none_algorithm": {
      "success": true,
      "modified_token": "eyJhbGciOiAibm9uZSIsICJ0eXAiOiAiSldUIn0.eyJzdWIiOiJ1c2VyMjAyIiwibmFtZSI6IlNlbnNpdGl2ZSBEYXRhIFVzZXIiLCJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJjcmVkaXRfY2FyZCI6IjQxMTEtMTExMS0xMTExLTExMTEiLCJwYXNzd29yZCI6Imhhc2hlZF9wYXNzd29yZF9oZXJlIiwiaWF0IjoxNzQyMTgxNjk0LCJleHAiOjE3NDIyNjgwOTR9.",
      "description": "Attempted to bypass signature validation by changing algorithm to 'none'"
    },
    "header_manipulation": {
      "success": true,
      "modified_token": "eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCIsICJqd2siOiB7Imt0eSI6ICJvY3QiLCAiayI6ICIifX0.eyJzdWIiOiJ1c2VyMjAyIiwibmFtZSI6IlNlbnNpdGl2ZSBEYXRhIFVzZXIiLCJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJjcmVkaXRfY2FyZCI6IjQxMTEtMTExMS0xMTExLTExMTEiLCJwYXNzd29yZCI6Imhhc2hlZF9wYXNzd29yZF9oZXJlIiwiaWF0IjoxNzQyMTgxNjk0LCJleHAiOjE3NDIyNjgwOTR9.F3v1ufWz8h9RlfJDk_fhMNRVYxVGH1reSq4aEnui-4o",
      "description": "Attempted to manipulate header parameters"
    },
    "weak_key": {
      "success": false,
      "cracked_secret": null,
      "description": "Attempted to crack the token using common weak secrets"
    }
  }
}